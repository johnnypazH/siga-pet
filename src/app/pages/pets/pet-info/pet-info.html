<!-- Usamos a pipe async para esperar os dados do pet$ chegarem -->
<div class="container mt-4" *ngIf="pet$ | async as pet; else loading">
  <div class="card shadow-sm">
    <div class="card-header bg-light py-3">
      <div class="d-flex justify-content-between align-items-center">
        <h2 class="mb-0">
          <i class="bi bi-heart-pulse-fill me-2"></i>
          Prontuário de {{ pet.nome }}
        </h2>
        <a routerLink="/pets" class="btn btn-outline-secondary">
          <i class="bi bi-arrow-left"></i> Voltar para a lista
        </a>
      </div>
    </div>
    <div class="card-body">
      <div class="row">
        <!-- Coluna de Informações Básicas -->
        <div class="col-md-6">
          <h4>Informações Básicas</h4>
          <ul class="list-group list-group-flush">
            <li class="list-group-item"><strong>Nome:</strong> {{ pet.nome }}</li>
            <li class="list-group-item"><strong>Espécie:</strong> {{ pet.especie.nome }}</li>
            <li class="list-group-item"><strong>Raça:</strong> {{ pet.raca }}</li>
            <li class="list-group-item"><strong>Sexo:</strong> {{ pet.sexo }}</li>
            <li class="list-group-item"><strong>Nascimento:</strong> {{ pet.nascimento | date:'dd/MM/yyyy' }}</li>
            <li class="list-group-item"><strong>Peso:</strong> {{ pet.peso }} kg</li>
          </ul>
        </div>

        <!-- Coluna de Informações do Tutor e Observações -->
        <div class="col-md-6">
          <h4>Tutor</h4>
          <ul class="list-group list-group-flush">
            <li class="list-group-item"><strong>Nome:</strong> {{ pet.tutor.nome }}</li>
            <li class="list-group-item"><strong>Telefone:</strong> {{ pet.tutor.telefone }}</li>
            <li class="list-group-item"><strong>Email:</strong> {{ pet.tutor.email }}</li>
          </ul>

          <h4 class="mt-4">Observações</h4>
          <p class="p-3 bg-light border rounded">
            {{ pet.observacoes || 'Nenhuma observação cadastrada.' }}
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Seção do Histórico de Prontuários -->
<div class="container mt-4" *ngIf="prontuarios$ | async as prontuarios">
  <div class="card shadow-sm">
    <div class="card-header bg-light py-3">
      <h3 class="mb-0">
        <i class="bi bi-file-earmark-medical-fill me-2"></i>
        Histórico de Atendimentos
      </h3>
    </div>
    <div class="card-body">
      <!-- Mensagem caso não haja registros -->
      <div *ngIf="prontuarios.length === 0; else listaProntuarios" class="text-center p-4">
        <p class="lead">Nenhum atendimento registrado para este pet.</p>
      </div>

      <!-- Lista de registros -->
      <ng-template #listaProntuarios>
        <div class="list-group">
          <div *ngFor="let prontuario of prontuarios" class="list-group-item list-group-item-action flex-column align-items-start mb-3 border rounded">
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1"><strong>Diagnóstico:</strong> {{ prontuario.diagnostico }}</h5>
              <small>{{ prontuario.data | date:'dd/MM/yyyy HH:mm' }}</small>
            </div>
            <p class="mb-1"><strong>Tratamento:</strong> {{ prontuario.tratamento }}</p>
            <p class="mb-1" *ngIf="prontuario.observacoes"><strong>Observações:</strong> {{ prontuario.observacoes }}</p>
            <small class="text-muted"><strong>Veterinário(a):</strong> {{ prontuario.funcionario?.nome || 'Não informado' }}</small>
          </div>
        </div>
      </ng-template>
    </div>
  </div>
</div>


<!-- Template para exibir enquanto os dados estão carregando -->
<ng-template #loading>
  <p class="text-center mt-5">Carregando informações do pet...</p>
</ng-template>
